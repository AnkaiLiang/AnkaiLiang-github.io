<!DOCTYPE html>
<html lang="en">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="Ankai Liang" />



<meta name="description" content="Page Rank by hadoop">
<meta name="keywords" content="Distrubute System">
<meta property="og:type" content="article">
<meta property="og:title" content="Page Rank - Hadoop">
<meta property="og:url" content="https://AnkaiLiang.github.io/2017/08/17/Page-Rank-Hadoop/index.html">
<meta property="og:site_name" content="Ankai Liang&#39;s Blog">
<meta property="og:description" content="Page Rank by hadoop">
<meta property="og:updated_time" content="2017-08-17T23:57:45.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Page Rank - Hadoop">
<meta name="twitter:description" content="Page Rank by hadoop">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="Ankai Liang&#39;s Blog" type="application/atom+xml">



    <link rel="shortcut icon" href="/img/favicon.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>Page Rank - Hadoop | Ankai Liang&#39;s Blog</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: undefined
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Ankai Liang</a></h1>
        </hgroup>

        
        <p class="header-subtitle">强而不燥，弱而不虚</p>
        

        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>Menu</li>
                        <li>Tags</li>
                        
                        <li>Friends</li>
                        
                        
                        <li>About Me</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">Home</a></li>
                        
                            <li><a href="/archives/">All Article</a></li>
                        
                            <li><a href="/tags/">tags</a></li>
                        
                            <li><a href="/about/">Resume</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="/lakeandgod@gmail.com" title="Email"></a>
                            
                                <a class="fa 新浪微博" href="http://weibo.com/1783077873/profile?rightmod=1&wvr=6&mod=personnumber" title="新浪微博"></a>
                            
                                <a class="fa GitHub" href="https://github.com/ankaiLiang" title="GitHub"></a>
                            
                                <a class="fa Facebook" href="https://www.facebook.com/lakeandgod" title="Facebook"></a>
                            
                                <a class="fa LinkedIn" href="https://www.linkedin.com/in/ankai-liang-a774b3119?trk=hp-identity-name" title="LinkedIn"></a>
                            
                                <a class="fa Instagram" href="https://www.instagram.com/ankai_liang/" title="Instagram"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AI/">AI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Distrubute-System/">Distrubute System</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/System-Administration/">System Administration</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="http://jayveehe.github.io">Jayvee He的博客</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://wangzi6147.github.io">wangzi的博客</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">true</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Ankai Liang</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Ankai Liang</a></h1>
            </hgroup>
            
            <p class="header-subtitle">强而不燥，弱而不虚</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">Home</a></li>
                
                    <li><a href="/archives/">All Article</a></li>
                
                    <li><a href="/tags/">tags</a></li>
                
                    <li><a href="/about/">Resume</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="/lakeandgod@gmail.com" title="Email"></a>
                            
                                <a class="fa 新浪微博" target="_blank" href="http://weibo.com/1783077873/profile?rightmod=1&wvr=6&mod=personnumber" title="新浪微博"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/ankaiLiang" title="GitHub"></a>
                            
                                <a class="fa Facebook" target="_blank" href="https://www.facebook.com/lakeandgod" title="Facebook"></a>
                            
                                <a class="fa LinkedIn" target="_blank" href="https://www.linkedin.com/in/ankai-liang-a774b3119?trk=hp-identity-name" title="LinkedIn"></a>
                            
                                <a class="fa Instagram" target="_blank" href="https://www.instagram.com/ankai_liang/" title="Instagram"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="Tags" friends="Friends" about="About Me"/>
</nav>
      <div class="body-wrap"><article id="post-Page-Rank-Hadoop" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/08/17/Page-Rank-Hadoop/" class="article-date">
      <time datetime="2017-08-17T23:43:25.000Z" itemprop="datePublished">2017-08-17</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Page Rank - Hadoop
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        

        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Distrubute-System/">Distrubute System</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="PageRank-Hadoop"><a href="#PageRank-Hadoop" class="headerlink" title="PageRank-Hadoop"></a>PageRank-Hadoop</h1><ul>
<li>Ankai Liang</li>
<li>10411998</li>
<li>CS 549 Assignment 5</li>
<li><a href="https://github.com/AnkaiLiang/Page-Rank-Hadoop" target="_blank" rel="external">code link</a></li>
</ul>
<h2 id="Code-Explanation"><a href="#Code-Explanation" class="headerlink" title="Code Explanation"></a>Code Explanation</h2><h3 id="PageRankDriver-java"><a href="#PageRankDriver-java" class="headerlink" title="PageRankDriver.java"></a>PageRankDriver.java</h3><p>In this snippet, I print my name in the method <code>composite()</code>, write another <code>composite()</code> to deal with the order which contains an equipartitioned join. And I change the code in <code>summarizeResult()</code> in order to output the result with an equipartitioned join.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">public class PageRankDriver &#123;</div><div class="line">	</div><div class="line">	public static final double DECAY = 0.85;</div><div class="line">	public static final String MARKER_DELIMITER = &quot;+&quot;;</div><div class="line">	public static final String MARKER_ADJ = &quot;ADJACENCY&quot;;</div><div class="line">	public static String nameInput = null;</div><div class="line">	...</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">public static void main(String[] args) throws Exception &#123;</div><div class="line"></div><div class="line">	String job = &quot;&quot;;</div><div class="line">	...</div><div class="line">	 else if (args.length == 7) // If number of input arguments is 7 and</div><div class="line">									// first input is == &quot;composite&quot;; parses</div><div class="line">									// data to composite</div><div class="line">	&#123;</div><div class="line">		if (job.equals(&quot;composite&quot;)) &#123;</div><div class="line">			composite(args[1], args[2], args[3], args[4], args[5],</div><div class="line">					Integer.parseInt(args[6]));</div><div class="line">		&#125; else // In case the function name doesn&apos;t match up</div><div class="line">		&#123;</div><div class="line">			System.err</div><div class="line">					.println(&quot;Please check the name of the function you wish to call and try again&quot;);</div><div class="line">		&#125;</div><div class="line">	&#125; else if (args.length == 8) // If number of input arguments is 8 and</div><div class="line">		// first input is == &quot;composite&quot;; parses</div><div class="line">		// data to composite</div><div class="line">	&#123;</div><div class="line">		if (job.equals(&quot;composite&quot;)) &#123;</div><div class="line">			composite(args[1], args[2], args[3], args[4], args[5], args[6],</div><div class="line">					Integer.parseInt(args[7]));</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	...</div><div class="line">	</div><div class="line">			if (i % 2 == 1) // As i increments at the last step, for odd i, interim2</div><div class="line">					// is the input directory</div><div class="line">	&#123;</div><div class="line">		deleteDirectory(interim1); // deletes other directory</div><div class="line">		counter++;</div><div class="line">		if (nameInput != null) &#123;</div><div class="line">			translate(nameInput, interim2, interim1, reducers);</div><div class="line">			finish(interim1, output, reducers);</div><div class="line">		&#125; else &#123;</div><div class="line">			finish(interim2, output, reducers);</div><div class="line">		&#125;</div><div class="line">		summarizeResult(output);</div><div class="line">	&#125; else // for even i, interim1 is the input directory</div><div class="line">	&#123;</div><div class="line">		deleteDirectory(interim2); // Deletes other directory</div><div class="line">		counter++;</div><div class="line">		if (nameInput != null) &#123;</div><div class="line">			translate(nameInput, interim1, interim2, reducers);</div><div class="line">			finish(interim2, output, reducers);</div><div class="line">		&#125; else &#123;</div><div class="line">			finish(interim1, output, reducers);</div><div class="line">		&#125;</div><div class="line">		summarizeResult(output);</div><div class="line">	&#125;</div><div class="line">	...</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">public static void composite(String input, String output, String interim1,</div><div class="line">		String interim2, String diff, int reducers) throws Exception &#123;</div><div class="line">	/*</div><div class="line">	 * TODO </div><div class="line">	 */</div><div class="line">	System.out.println(&quot;Ankai Liang (10411998)&quot;);</div><div class="line">	</div><div class="line">	int counter = 0;</div><div class="line">	...</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">public static void composite(String name, String input, String output, String interim1,</div><div class="line">		String interim2, String diff, int reducers) throws Exception &#123;</div><div class="line">	nameInput = name;</div><div class="line">	composite(input, output, interim1, interim2, diff, reducers);</div><div class="line">	nameInput = null;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">static void summarizeResult(String path) throws Exception &#123;</div><div class="line">	Path finpath = new Path(path); // Creates new Path</div><div class="line">	Configuration conf = new Configuration();</div><div class="line">	FileSystem fs = FileSystem.get(URI.create(path), conf);</div><div class="line">	HashMap&lt;String, Double&gt; values = new HashMap&lt;String, Double&gt;(); </div><div class="line">	...</div></pre></td></tr></table></figure>
<h3 id="InitMapper-java"><a href="#InitMapper-java" class="headerlink" title="InitMapper.java"></a>InitMapper.java</h3><ul>
<li>input:   nodeIdentifier : adjacency list</li>
<li>emit:   key = nodeIdentifier, value = adjacency list</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">public class InitMapper extends Mapper&lt;LongWritable, Text, Text, Text&gt; &#123;</div><div class="line"></div><div class="line">	public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException,</div><div class="line">			IllegalArgumentException &#123;</div><div class="line">		String line = value.toString(); // Converts Line to a String</div><div class="line">		/* </div><div class="line">		 * TODO: Just echo the input, since it is already in adjacency list format.</div><div class="line">		 */</div><div class="line">		String[] sections = line.split(&quot;:&quot;);</div><div class="line">		if (sections.length == 2)&#123;</div><div class="line">			context.write(new Text(sections[0].trim()),new Text(sections[1].trim()));</div><div class="line">		&#125;else</div><div class="line">			throw new IOException(&quot;Incorrect data format&quot;);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="InitReducer-java"><a href="#InitReducer-java" class="headerlink" title="InitReducer.java"></a>InitReducer.java</h3><ul>
<li>input: key = nodeIdentifier, values = vertexes the node links to </li>
<li>emit: key = nodeIdentifier+rank_value, value = adjacency list</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">public class InitReducer extends Reducer&lt;Text, Text, Text, Text&gt; &#123;</div><div class="line"></div><div class="line">	public void reduce(Text key, Iterable&lt;Text&gt; values, Context context) throws IOException, InterruptedException &#123;</div><div class="line">		/* </div><div class="line">		 * TODO: Output key: node+rank, value: adjacency list</div><div class="line">		 */</div><div class="line">		StringBuilder sb = new StringBuilder();</div><div class="line">		for (Text val : values)&#123;</div><div class="line">			sb.append(val.toString() + &quot; &quot;);</div><div class="line">		&#125;</div><div class="line">		context.write(new Text(key.toString() + PageRankDriver.MARKER_DELIMITER + &quot;1.0&quot;), new Text(sb.toString().trim()));</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="IterMapper-java"><a href="#IterMapper-java" class="headerlink" title="IterMapper.java"></a>IterMapper.java</h3><ul>
<li>input nodeIdentifier+rank_value | adjacency list</li>
<li>emit key = adj vertex, value = computed weight</li>
<li>emit key =  this vertex, value = adj List</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">public class IterMapper extends Mapper&lt;LongWritable, Text, Text, Text&gt; &#123;</div><div class="line"></div><div class="line">	public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException,</div><div class="line">			IllegalArgumentException &#123;</div><div class="line">		String line = value.toString(); // Converts Line to a String</div><div class="line">		String[] sections = line.split(&quot;\t&quot;); // Splits it into two parts. Part 1: node+rank | Part 2: adj list</div><div class="line"></div><div class="line">		if (sections.length &gt; 2) // Checks if the data is in the incorrect format</div><div class="line">		&#123;</div><div class="line">			throw new IOException(&quot;Incorrect data format&quot;);</div><div class="line">		&#125;</div><div class="line">		if (sections.length != 2) &#123;</div><div class="line">			return;</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		/* </div><div class="line">		 * TODO: emit key: adj vertex, value: computed weight.</div><div class="line">		 * </div><div class="line">		 * Remember to also emit the input adjacency list for this node!</div><div class="line">		 * Put a marker on the string value to indicate it is an adjacency list.</div><div class="line">		 */</div><div class="line">		String[] pair = sections[0].split(&quot;\\&quot;+PageRankDriver.MARKER_DELIMITER);</div><div class="line">		double rank = Double.valueOf(pair[1]);</div><div class="line">		String[] adjList = sections[1].split(&quot; &quot;);</div><div class="line">		double weight = rank / adjList.length;</div><div class="line">		</div><div class="line">		for (int i = 0; i &lt; adjList.length; i++)&#123;</div><div class="line">			context.write(new Text(adjList[i]), new Text(String.valueOf(weight)));</div><div class="line">		&#125;</div><div class="line">		context.write(new Text(pair[0]), new Text(PageRankDriver.MARKER_ADJ + &quot;:&quot; + sections[1]));</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="IterReducer-java"><a href="#IterReducer-java" class="headerlink" title="IterReducer.java"></a>IterReducer.java</h3><ul>
<li>input key = node, values = rankValues form adj vertexes Or adjacency list </li>
<li>emit key = node+rank, value = adjacency list</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">public class IterReducer extends Reducer&lt;Text, Text, Text, Text&gt; &#123;</div><div class="line">	public void reduce(Text key, Iterable&lt;Text&gt; values, Context context) throws IOException, InterruptedException &#123;</div><div class="line">		double d = PageRankDriver.DECAY; // Decay factor</div><div class="line">		/* </div><div class="line">		 * TODO: emit key:node+rank, value: adjacency list</div><div class="line">		 * Use PageRank algorithm to compute rank from weights contributed by incoming edges.</div><div class="line">		 * Remember that one of the values will be marked as the adjacency list for the node.</div><div class="line">		 */</div><div class="line">		double sum = 0;</div><div class="line">		String adjList = &quot;&quot;;</div><div class="line">		for (Text val:values)&#123;</div><div class="line">			String val_s = val.toString();</div><div class="line">			if (val_s.startsWith(PageRankDriver.MARKER_ADJ))</div><div class="line">				adjList = val_s.split(&quot;:&quot;)[1];</div><div class="line">			else sum += Double.valueOf(val.toString());</div><div class="line">		&#125;</div><div class="line">		double value = (1-d) + d * sum;</div><div class="line">		context.write(new Text(key.toString() + PageRankDriver.MARKER_DELIMITER + String.valueOf(value)), new Text(adjList));</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="DiffMap1-java"><a href="#DiffMap1-java" class="headerlink" title="DiffMap1.java"></a>DiffMap1.java</h3><ul>
<li>input node+rank (‘+’ is the delimiter)</li>
<li>emit key = node, value = rank</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">public class DiffMap1 extends Mapper&lt;LongWritable, Text, Text, Text&gt; &#123;</div><div class="line"></div><div class="line">	public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException,</div><div class="line">			IllegalArgumentException &#123;</div><div class="line">		String line = value.toString(); // Converts Line to a String</div><div class="line">		String[] sections = line.split(&quot;\t&quot;); // Splits each line</div><div class="line">		if (sections.length &gt; 2) // checks for incorrect data format</div><div class="line">		&#123;</div><div class="line">			throw new IOException(&quot;Incorrect data format&quot;);</div><div class="line">		&#125;</div><div class="line">		/**</div><div class="line">		 *  TODO: read node-rank pair and emit: key:node, value:rank</div><div class="line">		 */</div><div class="line">		String[] pair = sections[0].split(&quot;//&quot;+PageRankDriver.MARKER_DELIMITER);</div><div class="line">		if (pair.length == 2)</div><div class="line">			context.write(new Text(pair[0]), new Text(pair[1]));</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="DiffRed1-java"><a href="#DiffRed1-java" class="headerlink" title="DiffRed1.java"></a>DiffRed1.java</h3><ul>
<li>input key = node , values = 2 ranks</li>
<li>emit key = difference, value = “”</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">public class DiffRed1 extends Reducer&lt;Text, Text, Text, Text&gt; &#123;</div><div class="line"></div><div class="line">	public void reduce(Text key, Iterable&lt;Text&gt; values, Context context) throws IOException, InterruptedException &#123;</div><div class="line">		double[] ranks = new double[2];</div><div class="line">		/* </div><div class="line">		 * TODO: The list of values should contain two ranks.  Compute and output their difference.</div><div class="line">		 */</div><div class="line">		int i = 0;</div><div class="line">		for (Text val: values)&#123;</div><div class="line">			ranks[i++] = Double.valueOf(val.toString());</div><div class="line">			if (i &gt;= 2) break;</div><div class="line">		&#125;</div><div class="line">		context.write(new Text(String.valueOf(Math.abs(ranks[0] - ranks[1]))), new Text());</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="DiffMap2-java"><a href="#DiffMap2-java" class="headerlink" title="DiffMap2.java"></a>DiffMap2.java</h3><ul>
<li>input difference from DiffRed1</li>
<li>emit: key = “Difference” value = difference </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">public class DiffMap2 extends Mapper&lt;LongWritable, Text, Text, Text&gt; &#123;</div><div class="line"></div><div class="line">	public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException,</div><div class="line">			IllegalArgumentException &#123;</div><div class="line">		String s = value.toString(); // Converts Line to a String</div><div class="line"></div><div class="line">		/* </div><div class="line">		 * TODO: emit: key:&quot;Difference&quot; value:difference calculated in DiffRed1</div><div class="line">		 */</div><div class="line">		context.write(new Text(&quot;Difference&quot;), new Text(s.trim()));</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="DiffRed2-java"><a href="#DiffRed2-java" class="headerlink" title="DiffRed2.java"></a>DiffRed2.java</h3><ul>
<li>input difference</li>
<li>emit max_difference</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">public class DiffRed2 extends Reducer&lt;Text, Text, Text, Text&gt; &#123;</div><div class="line"></div><div class="line">	public void reduce(Text key, Iterable&lt;Text&gt; values, Context context) throws IOException, InterruptedException &#123;</div><div class="line">		double diff_max = 0.0; // sets diff_max to a default value</div><div class="line">		/* </div><div class="line">		 * TODO: Compute and emit the maximum of the differences</div><div class="line">		 */</div><div class="line">		for (Text val: values)&#123;</div><div class="line">			double diff = Double.valueOf(val.toString());</div><div class="line">			diff_max = Math.max(diff, diff_max);</div><div class="line">		&#125;</div><div class="line">		context.write(new Text(String.valueOf(diff_max)), new Text());</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="FinMapper-java"><a href="#FinMapper-java" class="headerlink" title="FinMapper.java"></a>FinMapper.java</h3><ul>
<li>input node+rank | adjList</li>
<li>emit key = -rank, value = node</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">public class FinMapper extends Mapper&lt;LongWritable, Text, DoubleWritable, Text&gt; &#123;</div><div class="line"></div><div class="line">	public void map(LongWritable key, Text value, Context context)</div><div class="line">			throws IOException, InterruptedException, IllegalArgumentException &#123;</div><div class="line">		String line = value.toString(); // Converts Line to a String</div><div class="line">		/*</div><div class="line">		 * TODO output key:-rank, value: node</div><div class="line">		 * See IterMapper for hints on parsing the output of IterReducer.</div><div class="line">		 */</div><div class="line">		String[] sections = line.split(&quot;\t&quot;);</div><div class="line">		String[] pair = sections[0].split(&quot;\\&quot; + PageRankDriver.MARKER_DELIMITER);</div><div class="line">		if (pair.length == 2 &amp;&amp; pair[1] != null &amp;&amp; !pair[1].equals(&quot;null&quot;))</div><div class="line">			context.write(new DoubleWritable(-Double.valueOf(pair[1])), new Text(pair[0]));</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="FinReducer-java"><a href="#FinReducer-java" class="headerlink" title="FinReducer.java"></a>FinReducer.java</h3><ul>
<li>input key = -rank, values = node</li>
<li>emit key = node, value = rank<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">public class FinReducer extends Reducer&lt;DoubleWritable, Text, Text, Text&gt; &#123;</div><div class="line"></div><div class="line">	public void reduce(DoubleWritable key, Iterable&lt;Text&gt; values, Context context) throws IOException,</div><div class="line">			InterruptedException &#123;</div><div class="line">		/* </div><div class="line">		 * TODO: For each value, emit: key:value, value:-rank</div><div class="line">		 */</div><div class="line">		for (Text val:values)&#123;</div><div class="line">			context.write(new Text(val), new Text(String.valueOf(-Double.valueOf(key.toString()))));</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="TranslateMap-java"><a href="#TranslateMap-java" class="headerlink" title="TranslateMap.java"></a>TranslateMap.java</h3><ul>
<li>input node+rank | adjList Or node: name</li>
<li>emit key = node, value = “NAME” + name</li>
<li>emit key = node, value = “RANK” + rank</li>
<li>emit key = node, value = “ADJADENCY” + adjList</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">public class TranslateMap extends Mapper&lt;LongWritable, Text, Text, Text&gt; &#123;</div><div class="line"></div><div class="line">	public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException, IllegalArgumentException &#123;</div><div class="line">		String line = value.toString();		</div><div class="line">		if (line.contains(&quot;:&quot;)) &#123;</div><div class="line">			//value = node : NAME</div><div class="line">			String[] sections = line.split(&quot;: &quot;);		</div><div class="line">			if (sections.length &gt;= 2) &#123;</div><div class="line">				context.write(new Text(sections[0]), </div><div class="line">						new Text(&quot;NAME&quot; + PageRankDriver.MARKER_DELIMITER + line.substring(line.indexOf(&apos;:&apos;) + 1).trim()));</div><div class="line">			&#125;</div><div class="line">		&#125; else &#123;</div><div class="line">			// value = node+rank | adjList</div><div class="line">			String[] sections = line.split(&quot;\t&quot;);</div><div class="line">			String[] pair = sections[0].trim().split(&quot;\\&quot;+PageRankDriver.MARKER_DELIMITER);</div><div class="line">			String rank = pair[1];</div><div class="line">			String list = (sections.length &gt; 1) ? sections[1].trim() : &quot;&quot;;</div><div class="line">			context.write(new Text(pair[0]), new Text(&quot;RANK&quot; + PageRankDriver.MARKER_DELIMITER + rank));</div><div class="line">			context.write(new Text(pair[0]), new Text(PageRankDriver.MARKER_ADJ + PageRankDriver.MARKER_DELIMITER + list));</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="TranslateRed-java"><a href="#TranslateRed-java" class="headerlink" title="TranslateRed.java"></a>TranslateRed.java</h3><ul>
<li>input node | “NAME” + name</li>
<li>input node | “RANK” + rank</li>
<li>input node | “ADJADENCY” + adjList</li>
<li>emit key = name Or node(if can’t match any name), value = adjList</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">public class TranslateRed extends Reducer&lt;Text, Text, Text, Text&gt; &#123;</div><div class="line"></div><div class="line">	public void reduce(Text key, Iterable&lt;Text&gt; values, Context context) throws IOException, InterruptedException &#123;</div><div class="line">		String node = key.toString();</div><div class="line">		String name = null;</div><div class="line">		String rank = null;</div><div class="line">		String list = null;</div><div class="line">		for(Text val : values) &#123;</div><div class="line">			String value = val.toString();</div><div class="line">			String[] pair = value.split(&quot;\\&quot;+PageRankDriver.MARKER_DELIMITER);</div><div class="line">			if (value.startsWith(&quot;NAME&quot;)) &#123;</div><div class="line">				name = (pair.length &gt; 1) ? pair[1]:null;</div><div class="line">			&#125; else if (value.startsWith(&quot;RANK&quot;)) &#123;</div><div class="line">				rank = (pair.length &gt; 1) ? pair[1]:null;</div><div class="line">			&#125; else if (value.startsWith(PageRankDriver.MARKER_ADJ)) &#123;</div><div class="line">				list = (pair.length &gt; 1) ? pair[1]:null;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		String outKey = ((name == null)? node : name) + PageRankDriver.MARKER_DELIMITER + rank;</div><div class="line">		String outValue = (list == null)? &quot;&quot; : list;</div><div class="line">		context.write(new Text(outKey), new Text(outValue));</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h2><h3 id="Local"><a href="#Local" class="headerlink" title="Local"></a>Local</h3><p>I test using the example graph in pdf.<br>Graph:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">1 : 2 3</div><div class="line">2 : 4</div><div class="line">3 : 1 4 5</div><div class="line">5 : 1 4</div></pre></td></tr></table></figure>
<p>Name:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">1: amazon</div><div class="line">2: pixer</div><div class="line">3: java</div><div class="line">4: google</div><div class="line">5: Ac Fun</div></pre></td></tr></table></figure>
<p>Output:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">google	1.708333333333333</div><div class="line">amazon	0.8583333333333333</div><div class="line">pixer	0.575</div><div class="line">java	0.575</div><div class="line">Ac Fun	0.43333333333333335</div></pre></td></tr></table></figure>
<h2 id="EMR"><a href="#EMR" class="headerlink" title="EMR"></a>EMR</h2><p>Result(5 reducers):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line">United_States_postal_abbreviations	17400.21276502926</div><div class="line">United_States	13078.758142261851</div><div class="line">Geographic_coordinate_system	11721.388760989967</div><div class="line">Biography	9046.94404539674</div><div class="line">2008	7074.6425361942565</div><div class="line">2007	6800.352714147496</div><div class="line">United_Kingdom	4910.857511340169</div><div class="line">Music_genre	4873.710868083095</div><div class="line">France	4742.359910022161</div><div class="line">Record_label	4693.041866616612</div><div class="line">Biological_classification	4504.695513826754</div><div class="line">England	4235.032041106078</div><div class="line">Canada	3690.885542951598</div><div class="line">Personal_name	3576.978399648568</div><div class="line">2006	3575.6745346145035</div><div class="line">Internet_Movie_Database	3463.2832928822127</div><div class="line">India	3106.5889721148874</div><div class="line">Binomial_nomenclature	2900.531729940027</div><div class="line">Germany	2813.7080608753836</div><div class="line">Australia	2801.5539246554167</div><div class="line">2005	2753.2105256013992</div><div class="line">Japan	2738.5863561278975</div><div class="line">Studio_album	2653.126455458513</div><div class="line">Village	2443.744194498339</div><div class="line">Record_producer	2390.2859118177685</div><div class="line">Football_(soccer)	2309.2199488266556</div><div class="line">Politician	2297.477993147134</div><div class="line">Romania	2223.1518281845247</div><div class="line">English_language	2213.6348292720913</div><div class="line">Time_zone	1995.897478274637</div><div class="line">Departments_of_France	1989.2385407660036</div><div class="line">Wiktionary	1986.601595665923</div><div class="line">Geocode	1957.2310712914546</div><div class="line">UN/LOCODE	1927.7685672468049</div><div class="line">2004	1923.7717011191974</div><div class="line">Television	1887.5449027795114</div><div class="line">Italy	1876.5179226178395</div><div class="line">Europe	1876.4133549775547</div><div class="line">Album	1862.5000237009542</div><div class="line">Conservation_status	1822.3255838594016</div><div class="line">Website	1786.3698129091722</div><div class="line">Animal	1755.4690932603446</div><div class="line">London	1750.4268351247983</div><div class="line">IUCN_Red_List	1693.081548359981</div><div class="line">Wikimedia_Commons	1691.2920868385286</div><div class="line">Poland	1660.9849679859221</div><div class="line">Population_density	1594.3872097107585</div><div class="line">Public_domain	1524.3655342422294</div><div class="line">Actor	1430.0997921719966</div><div class="line">Digital_object_identifier	1394.3430354664986</div><div class="line">2001	1372.891851411744</div><div class="line">Elevation	1359.6035580473917</div><div class="line">Norway	1354.81422265507</div><div class="line">China	1290.9928602406003</div><div class="line">School	1176.2465753102497</div></pre></td></tr></table></figure>
<h3 id="5-reducers-10-reducers-20-reducers"><a href="#5-reducers-10-reducers-20-reducers" class="headerlink" title="5 reducers ,10 reducers, 20 reducers"></a>5 reducers ,10 reducers, 20 reducers</h3><ul>
<li>1 master, 4 cores, spent 9 mins.</li>
<li>1 master, 9 cores, spent 6 mins 11 secs (first)</li>
<li>1 master, 9 cores, spent 5 mins 30 secs (second)</li>
<li>1 master, 19 cores, spent 4 mins 25secs（first）.</li>
<li>1 master, 19 cores, spent 4 mins 52secs (second)</li>
</ul>
<p>According to the different number reducers’ different time, we know that running twice with the exact same arguments<br>still show a notable difference. And we use the double reducers from 10 to 20, but the time cost didn’t improve as much as that. Because if we have too more reducers, more time will spend on comunication and calling function, rather than the benifit of increasing reducer. That means adding reducers may slow overall time.</p>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>Title:</span><a href="/2017/08/17/Page-Rank-Hadoop/">Page Rank - Hadoop</a></p>
        <p><span>Author:</span><a href="/" title="Back to Homepage">Ankai Liang</a></p>
        <p><span>Created:</span>2017-08-17, 19:43:25</p>
        <p><span>Updated:</span>2017-08-17, 19:57:45</p>
        <p>
            <span>Full URL:</span><a class="post-url" href="/2017/08/17/Page-Rank-Hadoop/" title="Page Rank - Hadoop">https://AnkaiLiang.github.io/2017/08/17/Page-Rank-Hadoop/</a>
            <span class="copy-path" data-clipboard-text="From https://AnkaiLiang.github.io/2017/08/17/Page-Rank-Hadoop/　　By Ankai Liang" title="Copy Article&#39;s Link &amp; Author"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>License:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"CC BY-NC-SA 4.0"</a> Keep Link &amp; Author if Distribute.
        </p>
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2017/08/17/DHT-REMOTE/">
                    DHT-REMOTE
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2017/08/17/RushHour/">
                    RushHour
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">Contents</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#PageRank-Hadoop"><span class="toc-number">1.</span> <span class="toc-text">PageRank-Hadoop</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Code-Explanation"><span class="toc-number">1.1.</span> <span class="toc-text">Code Explanation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PageRankDriver-java"><span class="toc-number">1.1.1.</span> <span class="toc-text">PageRankDriver.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InitMapper-java"><span class="toc-number">1.1.2.</span> <span class="toc-text">InitMapper.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InitReducer-java"><span class="toc-number">1.1.3.</span> <span class="toc-text">InitReducer.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IterMapper-java"><span class="toc-number">1.1.4.</span> <span class="toc-text">IterMapper.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IterReducer-java"><span class="toc-number">1.1.5.</span> <span class="toc-text">IterReducer.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DiffMap1-java"><span class="toc-number">1.1.6.</span> <span class="toc-text">DiffMap1.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DiffRed1-java"><span class="toc-number">1.1.7.</span> <span class="toc-text">DiffRed1.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DiffMap2-java"><span class="toc-number">1.1.8.</span> <span class="toc-text">DiffMap2.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DiffRed2-java"><span class="toc-number">1.1.9.</span> <span class="toc-text">DiffRed2.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FinMapper-java"><span class="toc-number">1.1.10.</span> <span class="toc-text">FinMapper.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FinReducer-java"><span class="toc-number">1.1.11.</span> <span class="toc-text">FinReducer.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TranslateMap-java"><span class="toc-number">1.1.12.</span> <span class="toc-text">TranslateMap.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TranslateRed-java"><span class="toc-number">1.1.13.</span> <span class="toc-text">TranslateRed.java</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Test"><span class="toc-number">1.2.</span> <span class="toc-text">Test</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Local"><span class="toc-number">1.2.1.</span> <span class="toc-text">Local</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EMR"><span class="toc-number">1.3.</span> <span class="toc-text">EMR</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-reducers-10-reducers-20-reducers"><span class="toc-number">1.3.1.</span> <span class="toc-text">5 reducers ,10 reducers, 20 reducers</span></a></li></ol></li></ol></li></ol>
</div>
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
</style>

<input type="button" id="tocButton" value="Hide"  title="Show or Hide Table of Contents">

<script>
    yiliaConfig.toc = ["Hide", "Show", !!"false"];
</script>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"Page Rank - Hadoop　| Ankai Liang's Blog　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    
      <div class="duoshuo" id="comments">
    <div id="comment-box" ></div>
    <div class="ds-thread" id="ds-thread" data-thread-key="2017/08/17/Page-Rank-Hadoop/" data-title="Page Rank - Hadoop" data-url="https://AnkaiLiang.github.io/2017/08/17/Page-Rank-Hadoop/"></div>
    <script>
        var duoshuoQuery = {short_name:"ankailiang"};
        var loadComment = function(){
            var d = document, s = d.createElement('script');
            s.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
            s.async = true; s.charset = 'UTF-8';
            (d.head || d.body).appendChild(s);
        }

        
    </script>
    
    <script> loadComment(); </script>

</div>
    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2017/08/17/DHT-REMOTE/" title="Pre: DHT-REMOTE">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="Mini Archives"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2017/08/17/RushHour/" title="Next: RushHour">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/08/17/DHT-REMOTE/">DHT-REMOTE</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/17/Page-Rank-Hadoop/">Page Rank - Hadoop</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/17/RushHour/">RushHour</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/17/Text-processing-in-Linux/">Text-Processing</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/17/afewmore-A-tool-of-ec2-how-to-write-a-shell-tool/">Afewmore</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/16/tcpdump-1-DNS/">Tcpdump(1) DNS</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/16/Using-Manages-packages-in-Linux/">Using Manages Packages in Linux</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/16/Using-the-AWS-CLI-to-set-instance/">Using the AWS-CLI to Set Instance</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/19/Install and Configure AWS Tools/">Install and Configure AWS Tools</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016-2017 Ankai Liang
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="A fast, simple &amp; powerful blog framework">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="Another simple and elegant theme for Hexo  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >Site Visitors: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">Page Hits: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#" title="Back to Top"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="Comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="Go to Bottom"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>